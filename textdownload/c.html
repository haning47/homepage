<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰¹é‡æª”æ¡ˆä¸‹è¼‰é€£çµç”Ÿæˆå™¨</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 8px;
        }
        label, textarea, button {
            display: block;
            width: 100%;
            margin-bottom: 10px;
            box-sizing: border-box;
        }
        textarea {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: vertical;
            min-height: 150px;
        }
        button {
            padding: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        .download-list a {
            display: block;
            margin: 8px 0;
            padding: 10px;
            background-color: #f4f4f4;
            border: 1px solid #eee;
            border-radius: 4px;
            text-decoration: none;
            color: #333;
        }
        .download-list a:hover {
            background-color: #e0e0e0;
        }
    </style>
</head>
<body>

    <div class="container">
        <h2>æ‰¹é‡æª”æ¡ˆä¸‹è¼‰é€£çµç”Ÿæˆå™¨</h2>
        <p>
            ğŸš¨ **é‡è¦é™åˆ¶:** æ­¤å·¥å…·ç„¡æ³•è‡ªå‹•æŠ“å–å¤–éƒ¨ç¶²é çš„é€£çµã€‚<br>
            è«‹å°‡æ‚¨è¦ä¸‹è¼‰çš„æª”æ¡ˆç¶²å€**æ‰‹å‹•è²¼å…¥**ä¸‹æ–¹çš„æ–‡å­—æ¡†ä¸­ï¼Œæ¯è¡Œä¸€å€‹ã€‚
        </p>

        <label for="urlList">æª”æ¡ˆç¶²å€åˆ—è¡¨ (æ¯è¡Œä¸€å€‹):</label>
        <textarea id="urlList" placeholder="è«‹è²¼å…¥æª”æ¡ˆçš„ URL&#10;ä¾‹å¦‚: https://example.com/doc1.pdf&#10;https://storage.net/image2.png"></textarea>

        <button onclick="generateDownloadLinks()">ç”Ÿæˆä¸‹è¼‰é€£çµ</button>

        <h3>ğŸ“¥ ä¸‹è¼‰åˆ—è¡¨ (è«‹é€ä¸€æˆ–å³éµé»æ“Šä¸‹è¼‰)</h3>
        <div id="downloadList" class="download-list">
            </div>

        <p id="status" style="color: red;"></p>
    </div>

    <script>
        /**
         * å˜—è©¦å¾ URL ä¸­æå–æª”åå’Œå‰¯æª”å
         * @param {string} url - æª”æ¡ˆçš„ URL
         * @returns {string} å»ºè­°çš„æª”å (åŒ…å«å‰¯æª”å)
         */
        function suggestFileName(url) {
            try {
                const urlObj = new URL(url);
                // 1. å˜—è©¦å¾è·¯å¾‘ä¸­ç²å–æœ€å¾Œä¸€æ®µä½œç‚ºæª”å
                let path = urlObj.pathname;
                let fileName = path.substring(path.lastIndexOf('/') + 1);

                // 2. å¦‚æœæª”ååŒ…å«æŸ¥è©¢åƒæ•¸ï¼Œç§»é™¤å®ƒå€‘
                if (fileName.includes('?')) {
                    fileName = fileName.substring(0, fileName.indexOf('?'));
                }
                
                // 3. å¦‚æœæª”åæ˜¯ç©ºçš„ (ä¾‹å¦‚ URL ä»¥ / çµå°¾)ï¼Œå‰‡ä½¿ç”¨é è¨­åç¨±
                if (fileName.length === 0 || fileName === '.') {
                    return 'downloaded_file';
                }

                // 4. å°æ–¼æ²’æœ‰æ˜é¡¯å‰¯æª”åçš„ URLï¼Œå˜—è©¦åœ¨è·¯å¾‘çµå°¾æ·»åŠ  .ext
                if (!fileName.includes('.')) {
                     // å‡è¨­ä¸€å€‹å¸¸è¦‹çš„é è¨­å‰¯æª”å
                     // ç”±æ–¼æˆ‘å€‘ä¸çŸ¥é“å¯¦éš›æª”æ¡ˆé¡å‹ï¼Œé€™æ˜¯æœ€å¥½çš„çŒœæ¸¬
                    return fileName + '.bin'; 
                }

                return decodeURIComponent(fileName);

            } catch (e) {
                // å¦‚æœ URL ç„¡æ•ˆ
                return 'downloaded_file';
            }
        }


        function generateDownloadLinks() {
            const urlListText = document.getElementById('urlList').value.trim();
            const downloadListDiv = document.getElementById('downloadList');
            const statusDiv = document.getElementById('status');
            downloadListDiv.innerHTML = '';
            statusDiv.textContent = '';

            const urls = urlListText.split('\n')
                                    .map(url => url.trim())
                                    .filter(url => url.length > 0);

            if (urls.length === 0) {
                statusDiv.textContent = 'è«‹è¼¸å…¥è‡³å°‘ä¸€å€‹æœ‰æ•ˆçš„æª”æ¡ˆç¶²å€ã€‚';
                return;
            }

            urls.forEach((url, index) => {
                const suggestedName = suggestFileName(url);

                const link = document.createElement('a');
                link.href = url;
                // ä½¿ç”¨ download å±¬æ€§ä¾†æŒ‡å®šæª”å
                link.download = `[${index + 1}] ${suggestedName}`;
                
                // è¨­å®šè¶…é€£çµæ–‡å­—ç‚ºæŒ‡å®šçš„æª”å
                link.textContent = `é»æ“Šä¸‹è¼‰: ${link.download}`; 

                downloadListDiv.appendChild(link);
            });

            statusDiv.textContent = 'ä¸‹è¼‰é€£çµå·²ç”Ÿæˆã€‚è«‹**é€ä¸€**é»æ“Šåˆ—è¡¨ä¸­çš„é€£çµé€²è¡Œä¸‹è¼‰ã€‚';
        }

        /*
        // æ­¤å‡½æ•¸ç”¨æ–¼å˜—è©¦è‡ªå‹•é»æ“Šæ‰€æœ‰é€£çµï¼Œä½†æœƒè¢«ç€è¦½å™¨å®‰å…¨æ©Ÿåˆ¶é˜»æ“‹
        // ä¸”æœƒå› ç‚ºè·¨åŸŸå•é¡Œå°è‡´æª”åå¤±æ•ˆï¼Œæ•…ä¸å»ºè­°ä½¿ç”¨ã€‚
        function autoDownloadAll() {
             const links = document.querySelectorAll('#downloadList a');
             if (links.length === 0) {
                 alert('è«‹å…ˆç”Ÿæˆä¸‹è¼‰é€£çµï¼');
                 return;
             }

             // è­¦å‘Šï¼šç€è¦½å™¨æœƒé˜»æ“‹é€™å€‹æ“ä½œï¼
             alert('è­¦å‘Šï¼šç€è¦½å™¨å°‡åªå…è¨±ç¬¬ä¸€æ¬¡ä¸‹è¼‰æˆ–å…¨éƒ¨é˜»æ“‹ã€‚');
             links.forEach(link => {
                 link.click();
             });
        }
        */
    </script>

</body>
</html>